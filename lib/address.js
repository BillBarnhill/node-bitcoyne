// Generated by IcedCoffeeScript 1.7.1-e
(function() {
  var SHA256, base58, bufeq_secure, check, kbpgp,
    __indexOf = [].indexOf || function(item) { for (var i = 0, l = this.length; i < l; i++) { if (i in this && this[i] === item) return i; } return -1; };

  kbpgp = require('kbpgp');

  SHA256 = kbpgp.hash.SHA256;

  base58 = kbpgp.base58;

  bufeq_secure = require('pgp-utils').util.bufeq_secure;

  exports.check = check = function(s, opts) {
    var buf, checksum1, checksum2, pkhash, v, versions;
    if (opts == null) {
      opts = {};
    }
    versions = opts.versions || [0, 5];
    buf = base58.decode(s);
    v = buf.readUInt8(0);
    if (!(__indexOf.call(versions, v) >= 0)) {
      return new Error("Bad version found: " + v);
    } else {
      pkhash = buf.slice(0, -4);
      checksum1 = buf.slice(-4);
      checksum2 = (SHA256(SHA256(pkhash))).slice(0, 4);
      if (!bufeq_secure(checksum1, checksum2)) {
        return new Error("Checksum mismatch");
      } else {
        return null;
      }
    }
  };

}).call(this);
